<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Άβακας μέχρι 9.999.999.999,999</title>
  <style>
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#fff;}
    .abacus-wrap{max-width:1200px;margin:18px auto;padding:16px;border-radius:16px;border:1px solid rgba(0,0,0,.12);background:#fff}
    .abacus-top{display:grid;grid-template-columns:1.3fr 1fr;gap:14px;align-items:start}
    @media (max-width:820px){.abacus-top{grid-template-columns:1fr}}
    .badge{display:inline-block;font-size:12px;padding:4px 10px;border-radius:999px;border:1px solid rgba(0,0,0,.12);margin-bottom:6px}
    h1{margin:0 0 6px 0;font-size:20px;line-height:1.2}
    .sub{margin:0;color:rgba(0,0,0,.7);font-size:14px}
    .panel{border:1px solid rgba(0,0,0,.12);border-radius:14px;padding:12px;display:grid;gap:10px;background:rgba(0,0,0,.02)}
    .label{font-size:12px;color:rgba(0,0,0,.65);margin-bottom:4px}
    .value{font-size:26px;font-weight:800;letter-spacing:.3px}
    .actions{display:flex;gap:10px;flex-wrap:wrap}
    .btn{appearance:none;border:1px solid rgba(0,0,0,.18);background:#fff;padding:8px 12px;border-radius:12px;cursor:pointer;font-weight:700;font-size:14px}
    .btn:hover{background:rgba(0,0,0,.03)}
    .btn:active{transform:translateY(1px)}
    .ghost{background:transparent}

    .words{
      margin-top:8px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(0,0,0,.12);
      background:#fff;
      font-size:14px;
      line-height:1.35;
      color:rgba(0,0,0,.85);
      min-height: 18px;
    }

    .board{margin-top:14px;padding:14px 10px;border-radius:16px;border:1px solid rgba(0,0,0,.12);background:linear-gradient(180deg,rgba(0,0,0,.02),rgba(0,0,0,.01));overflow-x:auto}

    /* Flex για να χωράει άνετα + separator */
    .grid{display:flex;gap:10px;min-width: 1450px; align-items: stretch}

    .col{min-width:110px;border-radius:14px;border:1px solid rgba(0,0,0,.10);background:#fff;padding:10px 8px;display:grid;gap:8px}
    .head{display:flex;align-items:baseline;justify-content:space-between;gap:10px;padding:0 4px}
    .col-label{font-size:12px;color:rgba(0,0,0,.70);font-weight:800}
    .col-digit{font-size:14px;font-weight:900}

    .beads{height:240px;border-radius:14px;border:1px solid rgba(0,0,0,.08);background:rgba(0,0,0,.02);display:grid;grid-template-rows:repeat(9,1fr);gap:8px;padding:10px}

    .bead{
      width:100%;
      border-radius:999px;
      border:1px solid rgba(0,0,0,.18);
      background:#fff;
      cursor:pointer;
      user-select:none;
      touch-action:manipulation;
    }

    .bead.on{
      background: var(--col, rgba(0,0,0,.85));
      border-color: var(--col, rgba(0,0,0,.85));
    }

    .bead:focus{outline:2px solid rgba(0,0,0,.35);outline-offset:2px}
    .foot{margin-top:10px;color:rgba(0,0,0,.7)}
    .labels-off .col-label{display:none}

    .col::before{
      content:"";
      display:block;
      height:6px;
      border-radius:999px;
      background: var(--col, rgba(0,0,0,.4));
      opacity:.9;
    }

    /* Διαχωριστικό υποδιαστολής */
    .sep{
      min-width:28px;
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius:14px;
      border:1px dashed rgba(0,0,0,.22);
      background:rgba(0,0,0,.02);
      font-weight:900;
      font-size:18px;
      color:rgba(0,0,0,.65);
      user-select:none;
      padding: 0 6px;
    }
  </style>
</head>
<body>
  <div id="abacus" class="abacus-wrap">
    <div class="abacus-top">
      <div>
        <span class="badge">Εργαλείο</span>
        <h1>Άβακας Θέσης Αξίας (μέχρι 9.999.999.999,999)</h1>
        <p class="sub">Πάτα τις χάντρες σε κάθε στήλη για να “χτίσεις” αριθμό. (0–9 ανά θέση)</p>
      </div>

      <div class="panel">
        <div>
          <div class="label">Αριθμός</div>
          <div id="readout" class="value">0,000</div>
          <div id="words" class="words" aria-live="polite"></div>
        </div>

        <div class="actions">
          <button type="button" id="reset" class="btn">Μηδενισμός</button>
          <button type="button" id="readWords" class="btn">Διάβασε τον αριθμό</button>
          <button type="button" id="toggle" class="btn ghost">Ετικέτες: ON</button>
        </div>
      </div>
    </div>

    <div class="board" role="group" aria-label="Άβακας μέχρι τα δισεκατομμύρια και δεκαδικά">
      <div id="grid" class="grid"></div>
    </div>

    <div class="foot">
      <small>Tip: Αν πατήσεις μια ήδη “ενεργή” χάντρα, μειώνει κατά 1.</small>
    </div>
  </div>

  <script>
  (function(){
    // Ακέραιο μέρος: 10 στήλες (δισεκατομμύρια → μονάδες)
    const placesInt = [
      { key: "B",  label: "Μονάδες δισ.",  pow: 9, color: "#7f1d1d" },
      { key: "HM", label: "Εκατ. εκατ.",   pow: 8, color: "#9a3412" },
      { key: "DM", label: "Δεκ. εκατ.",    pow: 7, color: "#b45309" },
      { key: "UM", label: "Μονάδες εκατ.", pow: 6, color: "#ca8a04" },
      { key: "HTh",label: "Εκατ. χιλ.",    pow: 5, color: "#15803d" },
      { key: "DTh",label: "Δεκ. χιλ.",     pow: 4, color: "#0f766e" },
      { key: "UTh",label: "Μονάδες χιλ.",  pow: 3, color: "#0369a1" },
      { key: "H",  label: "Εκατοντάδες",   pow: 2, color: "#1d4ed8" },
      { key: "D",  label: "Δεκάδες",       pow: 1, color: "#6d28d9" },
      { key: "U",  label: "Μονάδες",       pow: 0, color: "#be185d" }
    ];

    // Δεκαδικό μέρος: 3 στήλες (δέκατα → χιλιοστά)
    const placesDec = [
      { key: "TENTH",     label: "Δέκατα",    pow: -1, color: "#0ea5e9" },
      { key: "HUNDREDTH", label: "Εκατοστά",  pow: -2, color: "#22c55e" },
      { key: "THOUSANDTH",label: "Χιλιοστά",  pow: -3, color: "#f97316" }
    ];

    const state = { digits: {}, labelsOn: true };
    [...placesInt, ...placesDec].forEach(p => state.digits[p.key] = 0);

    const wrap = document.getElementById("abacus");
    const grid = document.getElementById("grid");
    const readout = document.getElementById("readout");
    const wordsBox = document.getElementById("words");

    const btnReset = document.getElementById("reset");
    const btnToggle = document.getElementById("toggle");
    const btnReadWords = document.getElementById("readWords");

    function buildColumn(p){
      const col = document.createElement("div");
      col.className = "col";
      col.dataset.key = p.key;
      col.style.setProperty("--col", p.color);

      const head = document.createElement("div");
      head.className = "head";

      const label = document.createElement("div");
      label.className = "col-label";
      label.textContent = p.label;

      const digit = document.createElement("div");
      digit.className = "col-digit";
      digit.id = `digit_${p.key}`;
      digit.textContent = "0";

      head.appendChild(label);
      head.appendChild(digit);

      const beads = document.createElement("div");
      beads.className = "beads";
      beads.setAttribute("role","group");
      beads.setAttribute("aria-label", p.label);

      for(let row=9; row>=1; row--){
        const b = document.createElement("button");
        b.type = "button";
        b.className = "bead";
        b.dataset.value = String(row);
        b.setAttribute("aria-label", `${p.label}: θέσε ${row}`);
        b.addEventListener("click", () => {
          const current = state.digits[p.key];
          const v = row;
          state.digits[p.key] = (v <= current) ? (v - 1) : v;
          render();
        });
        beads.appendChild(b);
      }

      col.appendChild(head);
      col.appendChild(beads);
      return col;
    }

    // Build integer columns
    placesInt.forEach(p => grid.appendChild(buildColumn(p)));

    // Add separator (comma)
    const sep = document.createElement("div");
    sep.className = "sep";
    sep.textContent = ",";
    sep.setAttribute("aria-hidden","true");
    grid.appendChild(sep);

    // Build decimal columns
    placesDec.forEach(p => grid.appendChild(buildColumn(p)));

    function computeValue(){
      // ακέραιο (0..9.999.999.999)
      let intN = 0;
      placesInt.forEach(p => intN += state.digits[p.key] * (10 ** p.pow));

      // δεκαδικά 3 ψηφία (000..999)
      const d1 = state.digits["TENTH"];
      const d2 = state.digits["HUNDREDTH"];
      const d3 = state.digits["THOUSANDTH"];

      return { intN, d1, d2, d3 };
    }

    function formatNumber({intN, d1, d2, d3}){
      const intStr = intN.toLocaleString("el-GR");
      return `${intStr},${d1}${d2}${d3}`;
    }

    /* ===== Ανάγνωση αριθμού στα Ελληνικά (έως 9.999.999.999) ===== */
    function joinClean(parts){
      return parts.filter(Boolean).join(" ").replace(/\s+/g," ").trim();
    }

    function under100(n){
      const u = ["μηδέν","ένα","δύο","τρία","τέσσερα","πέντε","έξι","επτά","οκτώ","εννέα"];
      const tenTo19 = ["δέκα","έντεκα","δώδεκα","δεκατρία","δεκατέσσερα","δεκαπέντε","δεκαέξι","δεκαεπτά","δεκαοκτώ","δεκαεννέα"];
      const tens = ["","", "είκοσι","τριάντα","σαράντα","πενήντα","εξήντα","εβδομήντα","ογδόντα","ενενήντα"];
      if(n < 10) return u[n];
      if(n < 20) return tenTo19[n-10];
      const t = Math.floor(n/10);
      const r = n%10;
      if(r === 0) return tens[t];
      return `${tens[t]} ${u[r]}`;
    }

    function under1000(n){
      if(n === 0) return "";
      const hundreds = ["","εκατό","διακόσια","τριακόσια","τετρακόσια","πεντακόσια","εξακόσια","επτακόσια","οκτακόσια","εννιακόσια"];
      const h = Math.floor(n/100);
      const r = n%100;
      const parts = [];
      if(h > 0) parts.push(hundreds[h]);
      if(r > 0) parts.push(under100(r));
      return joinClean(parts);
    }

    function numberToGreekWordsInt(n){
      if(n === 0) return "μηδέν";

      const billions  = Math.floor(n / 1_000_000_000);              // 0..9
      const millions  = Math.floor((n % 1_000_000_000) / 1_000_000); // 0..999
      const thousands = Math.floor((n % 1_000_000) / 1_000);         // 0..999
      const units     = n % 1_000;                                   // 0..999

      const parts = [];

      if(billions){
        const bWord = under100(billions);
        parts.push(billions === 1 ? "ένα δισεκατομμύριο" : `${bWord} δισεκατομμύρια`);
      }

      if(millions){
        const mWord = under1000(millions);
        parts.push(millions === 1 ? "ένα εκατομμύριο" : `${mWord} εκατομμύρια`);
      }

      if(thousands){
        if(thousands === 1){
          parts.push("χίλια");
        } else {
          const thWord = under1000(thousands);
          parts.push(`${thWord} χιλιάδες`);
        }
      }

      if(units){
        parts.push(under1000(units));
      }

      return joinClean(parts);
    }

    function decimalWords(d1,d2,d3){
      if(d1===0 && d2===0 && d3===0) return "";
      const parts = [];

      if(d1){
        parts.push(`${under100(d1)} ${d1===1 ? "δέκατο" : "δέκατα"}`);
      }
      if(d2){
        parts.push(`${under100(d2)} ${d2===1 ? "εκατοστό" : "εκατοστά"}`);
      }
      if(d3){
        parts.push(`${under100(d3)} ${d3===1 ? "χιλιοστό" : "χιλιοστά"}`);
      }

      return "και " + parts.join(" και ");
    }
    /* ===== END ===== */

    function render(){
      // update digits + beads (integer + decimals)
      [...placesInt, ...placesDec].forEach(p => {
        const col = grid.querySelector(`.col[data-key="${p.key}"]`);
        const digitEl = document.getElementById(`digit_${p.key}`);
        const digit = state.digits[p.key];
        digitEl.textContent = String(digit);

        const beadButtons = Array.from(col.querySelectorAll(".bead"));
        beadButtons.forEach(btn => {
          const v = parseInt(btn.dataset.value, 10);
          if(v <= digit) btn.classList.add("on");
          else btn.classList.remove("on");
        });
      });

      const v = computeValue();
      readout.textContent = formatNumber(v);
    }

    btnReset.addEventListener("click", () => {
      Object.keys(state.digits).forEach(k => state.digits[k] = 0);
      wordsBox.textContent = "";
      render();
    });

    btnToggle.addEventListener("click", () => {
      state.labelsOn = !state.labelsOn;
      wrap.classList.toggle("labels-off", !state.labelsOn);
      btnToggle.textContent = state.labelsOn ? "Ετικέτες: ON" : "Ετικέτες: OFF";
    });

    btnReadWords.addEventListener("click", () => {
      const { intN, d1, d2, d3 } = computeValue();
      const main = numberToGreekWordsInt(intN);
      const dec = decimalWords(d1,d2,d3);
      wordsBox.textContent = joinClean([main, dec]);
    });

    render();
  })();
  </script>
</body>
</html>
